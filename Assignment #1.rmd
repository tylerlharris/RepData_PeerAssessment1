---
title: "Rep Research Assignment 1"
author: "Tyler Harris"
date: "Wednesday, August 05, 2015"
output: html_document
---

```{r}
library(dplyr)
library(ggplot2)
activity <- tbl_df(read.csv("activity.csv")) 

## Remove missing values:
filter(activity, steps != "NA") -> activity.f
group_by(activity.f, date) -> activity.fg
summarise(activity.fg, total = sum(steps)) -> act_sum
```


```{r, echo = F}
##Create the histogram
p <- ggplot(data = act_sum, mapping = aes(x = as.Date(date), y = total))

p + layer(geom = "histogram", stat = "identity") -> p

p + labs(title = "Total Number of Steps Taken Each Day", x = "Date", y = "Total Steps") -> p
p
```


```{r}
##Find Mean and Median

summarise(act_sum, Mean = mean(total), Median = median(total))
```
```{r}
group_by(activity, interval) -> g_act

select(g_act, steps) -> g_act_s

summarise(g_act_s, Mean = mean(steps, na.rm = T)) -> m_act




## The plot:

j <- ggplot(data = m_act, mapping = aes(x = interval, y = Mean))

j <- j + layer(geom = "line")

j <- j + labs(title = "Average Steps at Each Interval", x = "Interval", y = "Average Steps")
j

## Find the row of the highest mean

max(m_act$Mean) -> mmax

which(grepl(mmax, m_act$Mean)) -> m

m_act[m,] ##Answer: Max is at interval 835.
```
```{r}
## Find the number of NA's:

activity[is.na(activity$steps),] -> NAs

length(NAs$steps)

## Function for creating NA value.
## instead of m_act:

group_by(activity, date) -> gd_act

select(gd_act, steps) -> gd_act_s
summarise(gd_act_s, Mean = mean(steps, na.rm = T)) -> d_act
d_act$Mean[is.nan(d_act$Mean)] <- 0

NAmer <- tbl_df(merge(NAs, d_act, by.x = "date", by.y = "date"))
arrange(NAmer, date) -> NAmer
activity2 <- activity
activity2$steps[is.na(activity2$steps)] <- 
  NAmer$Mean[match(activity$steps, NAmer$steps)][is.na(activity$steps)]

group_by(activity2, date) -> activity2_g
summarise(activity2_g, total = sum(steps)) -> act2_sum
## Plot:

k <- ggplot(data = act2_sum, mapping = aes(x = as.Date(date), y = total))

k + layer(geom = "histogram", stat = "identity") -> k

k + labs(title = "Total Steps Each Day", x = "Date", y = "Total Steps") -> k
k
##Mean and Median:

summarise(act2_sum, Mean = mean(total), Median = median(total))